{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-3">üìå –°–ø–∏—Å–æ–∫ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π</h2>

    <!-- –§–æ—Ä–º–∞ –ø–æ—à—É–∫—É -->
    <form method="get" class="row g-3">
        <div class="col-md-3">
            <input type="text" name="search" class="form-control" placeholder="üîç –ü–æ—à—É–∫ –∑–∞ –Ω–∞–∑–≤–æ—é —Ç–∞–±–ª–∏—Ü—ñ"
                   value="{{ request.GET.search|default_if_none:'' }}">
        </div>
        <div class="col-md-2">
            <input type="number" step="0.01" name="min_amount" class="form-control" placeholder="–ú—ñ–Ω. —Å—É–º–∞"
                   value="{{ request.GET.min_amount|default_if_none:'' }}">
        </div>
        <div class="col-md-2">
            <input type="number" step="0.01" name="max_amount" class="form-control" placeholder="–ú–∞–∫—Å. —Å—É–º–∞"
                   value="{{ request.GET.max_amount|default_if_none:'' }}">
        </div>
        <div class="col-md-2">
            <input type="date" name="start_date" class="form-control" value="{{ request.GET.start_date|default_if_none:'' }}">
        </div>
        <div class="col-md-2">
            <input type="date" name="end_date" class="form-control" value="{{ request.GET.end_date|default_if_none:'' }}">
        </div>
        <div class="col-md-1">
            <button type="submit" class="btn btn-primary">–§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏</button>
        </div>
        <div class="col-md-1">
            <a href="?" class="btn btn-outline-secondary">–°–∫–∏–Ω—É—Ç–∏</a>
        </div>
    </form>

    <hr>

    <!-- –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –∑–∞–≥–∞–ª—å–Ω–∏—Ö –≤–∏—Ç—Ä–∞—Ç —É –≤—Å—ñ—Ö –≤–∞–ª—é—Ç–∞—Ö -->
    <div class="alert alert-info">
        <h4>üìä –ó–∞–≥–∞–ª—å–Ω—ñ –≤–∏—Ç—Ä–∞—Ç–∏:</h4>
        <ul class="list-unstyled">
            {% for currency, amount in total_amounts.items %}
                <li><strong>{{ amount|floatformat:2 }} {{ currency }}</strong></li>
            {% endfor %}
        </ul>
        <p><strong>üí∞ –í—Å—å–æ–≥–æ —É UAH:</strong> {{ total_uah|floatformat:2 }} UAH</p>
    </div>

    <hr>

    <!-- –¢–∞–±–ª–∏—Ü—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π -->
    <div class="table-responsive">
        <table class="table table-bordered table-hover">
            <thead class="table-dark">
                <tr>
                    <th>–°—É–º–∞</th>
                    <th>–í–∞–ª—é—Ç–∞</th>
                    <th>–î–∞—Ç–∞</th>
                    <th>–¢–∞–±–ª–∏—Ü—è</th>
                    <th>–ö–∞—Ç–µ–≥–æ—Ä—ñ—ó</th>
                    <th>–î—ñ—ó</th>
                </tr>
            </thead>
            <tbody>
                
                {% for transaction in transactions %}
                <tr>
                    <td>{{ transaction.amount }}</td>
                    <td>{{ transaction.currency }}</td>
                    <td>{{ transaction.date }}</td>
                    <td>{{ transaction.table.name }}</td>
                    <td>
                        {% for category in transaction.categories.all %}
                            <span class="badge bg-info">{{ category.name }}</span>
                        {% endfor %}
                    </td>
                    <td>
                        <a href="{% url 'transaction_update' transaction.id %}" class="btn btn-warning btn-sm">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</a>
                        <a href="{% url 'transaction_delete' transaction.id %}" class="btn btn-danger btn-sm">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6" class="text-center">–ù–µ–º–∞—î —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ–π.</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <a href="{% url 'transaction_create' %}" class="btn btn-success">‚ûï –î–æ–¥–∞—Ç–∏ —Ç—Ä–∞–Ω–∑–∞–∫—Ü—ñ—é</a>
</div>
{% endblock %}

